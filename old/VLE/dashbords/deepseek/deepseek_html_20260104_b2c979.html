{% comment %} system_settings.html {% endcomment %}
{% extends "main.html" %}

{% block title %}System Settings - University VLE{% endblock %}

{% block navigation %}
    {% include "admin_navigation.html" %}
{% endblock %}

{% block body %}
<div class="system-settings">
    <!-- Page Header -->
    <div class="page-header">
        <h1 class="page-title">
            <i class="fas fa-cogs"></i> System Settings
        </h1>
        <p class="page-subtitle">
            Configure system preferences, security settings, and platform configurations
        </p>
    </div>

    <!-- Settings Navigation -->
    <div class="settings-navigation card">
        <div class="settings-tabs">
            <button class="settings-tab active" onclick="showSettingsTab('general')">
                <i class="fas fa-sliders-h"></i>
                <span>General</span>
            </button>
            <button class="settings-tab" onclick="showSettingsTab('security')">
                <i class="fas fa-shield-alt"></i>
                <span>Security</span>
            </button>
            <button class="settings-tab" onclick="showSettingsTab('email')">
                <i class="fas fa-envelope"></i>
                <span>Email</span>
            </button>
            <button class="settings-tab" onclick="showSettingsTab('notifications')">
                <i class="fas fa-bell"></i>
                <span>Notifications</span>
            </button>
            <button class="settings-tab" onclick="showSettingsTab('backup')">
                <i class="fas fa-database"></i>
                <span>Backup</span>
            </button>
            <button class="settings-tab" onclick="showSettingsTab('maintenance')">
                <i class="fas fa-tools"></i>
                <span>Maintenance</span>
            </button>
        </div>
    </div>

    <!-- General Settings -->
    <div id="generalTab" class="settings-tab-content active">
        <div class="settings-section card">
            <div class="settings-header">
                <h3 class="settings-title">
                    <i class="fas fa-sliders-h"></i> General Settings
                </h3>
                <p class="settings-description">
                    Configure basic system preferences and platform settings
                </p>
            </div>
            
            <form class="settings-form" id="generalSettingsForm">
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-university"></i>
                        Platform Name
                    </label>
                    <input type="text" class="form-control" value="University VLE" placeholder="Enter platform name">
                    <small class="form-hint">This name appears in page titles and emails</small>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-globe"></i>
                        Default Language
                    </label>
                    <select class="form-control">
                        <option value="en" selected>English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="zh">Chinese</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-clock"></i>
                        Time Zone
                    </label>
                    <select class="form-control">
                        <option value="UTC" selected>UTC (Coordinated Universal Time)</option>
                        <option value="America/New_York">EST (Eastern Time)</option>
                        <option value="America/Chicago">CST (Central Time)</option>
                        <option value="America/Denver">MST (Mountain Time)</option>
                        <option value="America/Los_Angeles">PST (Pacific Time)</option>
                        <option value="Europe/London">GMT (London)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-calendar-alt"></i>
                        Date Format
                    </label>
                    <select class="form-control">
                        <option value="Y-m-d" selected>YYYY-MM-DD (2024-01-15)</option>
                        <option value="m/d/Y">MM/DD/YYYY (01/15/2024)</option>
                        <option value="d/m/Y">DD/MM/YYYY (15/01/2024)</option>
                        <option value="F j, Y">Month Day, Year (January 15, 2024)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-user-plus"></i>
                        User Registration
                    </label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="registration" value="open" checked>
                            <span>Open Registration</span>
                            <small>Anyone can register, admin approval required</small>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="registration" value="invite">
                            <span>Invite Only</span>
                            <small>Users can only register with invitation codes</small>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="registration" value="closed">
                            <span>Closed</span>
                            <small>Only admins can create new accounts</small>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-upload"></i>
                        File Upload Limits
                    </label>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Max File Size</label>
                            <div class="input-with-unit">
                                <input type="number" class="form-control" value="10" min="1" max="100">
                                <span class="input-unit">MB</span>
                            </div>
                        </div>
                        <div class="form-col">
                            <label>Allowed Types</label>
                            <select class="form-control" multiple style="height: 120px;">
                                <option value="pdf" selected>PDF Documents</option>
                                <option value="doc" selected>Word Documents</option>
                                <option value="xls" selected>Excel Files</option>
                                <option value="ppt" selected>PowerPoint</option>
                                <option value="jpg" selected>JPEG Images</option>
                                <option value="png" selected>PNG Images</option>
                                <option value="zip">ZIP Archives</option>
                                <option value="mp4">MP4 Videos</option>
                                <option value="mp3">MP3 Audio</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="settings-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save General Settings
                    </button>
                    <button type="button" class="btn btn-outline" onclick="resetGeneralSettings()">
                        <i class="fas fa-undo"></i> Reset to Default
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Security Settings -->
    <div id="securityTab" class="settings-tab-content">
        <div class="settings-section card">
            <div class="settings-header">
                <h3 class="settings-title">
                    <i class="fas fa-shield-alt"></i> Security Settings
                </h3>
                <p class="settings-description">
                    Configure security policies, authentication, and access controls
                </p>
            </div>
            
            <form class="settings-form" id="securitySettingsForm">
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-lock"></i>
                        Password Policy
                    </label>
                    <div class="checkbox-group">
                        <label class="checkbox-option">
                            <input type="checkbox" name="password_min_length" checked>
                            <span>Minimum length: 8 characters</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="password_uppercase" checked>
                            <span>Require uppercase letters</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="password_lowercase" checked>
                            <span>Require lowercase letters</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="password_numbers" checked>
                            <span>Require numbers</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="password_special">
                            <span>Require special characters</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="password_history" checked>
                            <span>Prevent password reuse (last 5 passwords)</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-user-clock"></i>
                        Session Management
                    </label>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Session Timeout</label>
                            <div class="input-with-unit">
                                <input type="number" class="form-control" value="30" min="5" max="240">
                                <span class="input-unit">minutes</span>
                            </div>
                            <small>Automatically log out inactive users</small>
                        </div>
                        <div class="form-col">
                            <label>Max Login Attempts</label>
                            <div class="input-with-unit">
                                <input type="number" class="form-control" value="5" min="1" max="10">
                                <span class="input-unit">attempts</span>
                            </div>
                            <small>Before temporary lockout</small>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-key"></i>
                        Two-Factor Authentication
                    </label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="2fa" value="disabled" checked>
                            <span>Disabled</span>
                            <small>No 2FA required</small>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="2fa" value="optional">
                            <span>Optional</span>
                            <small>Users can enable 2FA if desired</small>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="2fa" value="admin">
                            <span>Admins Only</span>
                            <small>Required for administrator accounts</small>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="2fa" value="all">
                            <span>Required for All</span>
                            <small>All users must use 2FA</small>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-ban"></i>
                        IP Restrictions
                    </label>
                    <div class="checkbox-group">
                        <label class="checkbox-option">
                            <input type="checkbox" name="ip_whitelist">
                            <span>Enable IP Whitelist</span>
                            <small>Only allow access from specific IPs</small>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="ip_blacklist">
                            <span>Enable IP Blacklist</span>
                            <small>Block specific IP addresses</small>
                        </label>
                    </div>
                    <div class="ip-lists" style="margin-top: 1rem;">
                        <div class="form-row">
                            <div class="form-col">
                                <label>Allowed IPs (Whitelist)</label>
                                <textarea class="form-control" rows="4" placeholder="Enter IP addresses (one per line)"></textarea>
                            </div>
                            <div class="form-col">
                                <label>Blocked IPs (Blacklist)</label>
                                <textarea class="form-control" rows="4" placeholder="Enter IP addresses (one per line)"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-history"></i>
                        Security Log Retention
                    </label>
                    <div class="input-with-unit">
                        <input type="number" class="form-control" value="90" min="1" max="365">
                        <span class="input-unit">days</span>
                    </div>
                    <small>How long to keep security logs and audit trails</small>
                </div>
                
                <div class="settings-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Security Settings
                    </button>
                    <button type="button" class="btn btn-outline" onclick="runSecurityScan()">
                        <i class="fas fa-shield-check"></i> Run Security Scan
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Email Settings -->
    <div id="emailTab" class="settings-tab-content">
        <div class="settings-section card">
            <div class="settings-header">
                <h3 class="settings-title">
                    <i class="fas fa-envelope"></i> Email Settings
                </h3>
                <p class="settings-description">
                    Configure email server settings and notification templates
                </p>
            </div>
            
            <form class="settings-form" id="emailSettingsForm">
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-server"></i>
                        SMTP Server Configuration
                    </label>
                    <div class="form-row">
                        <div class="form-col">
                            <label>SMTP Host</label>
                            <input type="text" class="form-control" value="smtp.gmail.com" placeholder="smtp.example.com">
                        </div>
                        <div class="form-col">
                            <label>Port</label>
                            <input type="number" class="form-control" value="587" placeholder="587">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Username</label>
                            <input type="text" class="form-control" placeholder="your-email@example.com">
                        </div>
                        <div class="form-col">
                            <label>Password</label>
                            <input type="password" class="form-control" placeholder="SMTP password">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Encryption</label>
                            <select class="form-control">
                                <option value="tls" selected>TLS</option>
                                <option value="ssl">SSL</option>
                                <option value="none">None</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>From Email</label>
                            <input type="email" class="form-control" value="noreply@university.edu" placeholder="noreply@example.com">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-paper-plane"></i>
                        Email Templates
                    </label>
                    <div class="email-templates">
                        <div class="template-item">
                            <h4>Welcome Email</h4>
                            <p>Sent to new users after registration approval</p>
                            <button type="button" class="btn btn-sm btn-outline" onclick="editTemplate('welcome')">
                                <i class="fas fa-edit"></i> Edit Template
                            </button>
                        </div>
                        <div class="template-item">
                            <h4>Password Reset</h4>
                            <p>Sent when users request password reset</p>
                            <button type="button" class="btn btn-sm btn-outline" onclick="editTemplate('password_reset')">
                                <i class="fas fa-edit"></i> Edit Template
                            </button>
                        </div>
                        <div class="template-item">
                            <h4>Announcement Notifications</h4>
                            <p>Sent for important announcements</p>
                            <button type="button" class="btn btn-sm btn-outline" onclick="editTemplate('announcement')">
                                <i class="fas fa-edit"></i> Edit Template
                            </button>
                        </div>
                        <div class="template-item">
                            <h4>Grade Notifications</h4>
                            <p>Sent when grades are posted</p>
                            <button type="button" class="btn btn-sm btn-outline" onclick="editTemplate('grades')">
                                <i class="fas fa-edit"></i> Edit Template
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-bell"></i>
                        Email Notifications
                    </label>
                    <div class="checkbox-group">
                        <label class="checkbox-option">
                            <input type="checkbox" name="email_registration" checked>
                            <span>Send registration confirmation emails</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="email_approval" checked>
                            <span>Send account approval notifications</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="email_announcements" checked>
                            <span>Send announcement emails</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="email_grades" checked>
                            <span>Send grade notifications</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="email_assignment">
                            <span>Send assignment due reminders</span>
                        </label>
                    </div>
                </div>
                
                <div class="settings-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Email Settings
                    </button>
                    <button type="button" class="btn btn-outline" onclick="testEmailConnection()">
                        <i class="fas fa-envelope"></i> Test Connection
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Other tabs would continue similarly -->
    
    <!-- Quick Settings Summary -->
    <div class="settings-summary card">
        <div class="settings-header">
            <h3 class="settings-title">
                <i class="fas fa-info-circle"></i> Current Configuration
            </h3>
        </div>
        <div class="summary-grid">
            <div class="summary-item">
                <div class="summary-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="summary-content">
                    <h4>User Registration</h4>
                    <p>Open with Admin Approval</p>
                </div>
            </div>
            <div class="summary-item">
                <div class="summary-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="summary-content">
                    <h4>Security Level</h4>
                    <p>Standard</p>
                </div>
            </div>
            <div class="summary-item">
                <div class="summary-icon">
                    <i class="fas fa-envelope"></i>
                </div>
                <div class="summary-content">
                    <h4>Email Status</h4>
                    <p>Configured</p>
                </div>
            </div>
            <div class="summary-item">
                <div class="summary-icon">
                    <i class="fas fa-database"></i>
                </div>
                <div class="summary-content">
                    <h4>Last Backup</h4>
                    <p>Yesterday, 02:00 AM</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block style %}
<style>
    .system-settings {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    /* Settings Navigation */
    .settings-navigation {
        padding: 0;
        overflow: hidden;
    }

    .settings-tabs {
        display: flex;
        overflow-x: auto;
        border-bottom: 2px solid var(--gray-light);
    }

    .settings-tab {
        padding: 1rem 1.5rem;
        background: none;
        border: none;
        font-size: 0.95rem;
        font-weight: 500;
        color: var(--gray);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        transition: var(--transition);
        white-space: nowrap;
        position: relative;
    }

    .settings-tab:hover {
        color: var(--primary);
        background: var(--primary-light);
    }

    .settings-tab.active {
        color: var(--primary);
        border-bottom: 2px solid var(--primary);
        margin-bottom: -2px;
    }

    .settings-tab i {
        font-size: 1.1rem;
    }

    /* Settings Tabs Content */
    .settings-tab-content {
        display: none;
        animation: fadeIn 0.3s ease;
    }

    .settings-tab-content.active {
        display: block;
    }

    /* Settings Section */
    .settings-section {
        margin-bottom: 1.5rem;
    }

    .settings-header {
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--primary-light);
    }

    .settings-title {
        font-size: 1.5rem;
        color: var(--dark);
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .settings-description {
        color: var(--gray);
        font-size: 1rem;
        line-height: 1.5;
    }

    /* Settings Form */
    .settings-form {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }

    /* Radio and Checkbox Groups */
    .radio-group,
    .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .radio-option,
    .checkbox-option {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        padding: 1rem;
        border: 1px solid var(--gray-light);
        border-radius: 8px;
        cursor: pointer;
        transition: var(--transition);
    }

    .radio-option:hover,
    .checkbox-option:hover {
        border-color: var(--primary);
        background: var(--primary-light);
    }

    .radio-option input[type="radio"],
    .checkbox-option input[type="checkbox"] {
        margin-top: 0.25rem;
        accent-color: var(--primary);
    }

    .radio-option span,
    .checkbox-option span {
        font-weight: 500;
        color: var(--dark);
        flex: 1;
    }

    .radio-option small,
    .checkbox-option small {
        display: block;
        font-size: 0.85rem;
        color: var(--gray);
        margin-top: 0.25rem;
    }

    /* Form Row and Column */
    .form-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
    }

    .form-col {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    /* Input with Unit */
    .input-with-unit {
        position: relative;
    }

    .input-unit {
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray);
        font-weight: 500;
        pointer-events: none;
    }

    .input-with-unit .form-control {
        padding-right: 3rem;
    }

    /* IP Lists */
    .ip-lists textarea {
        font-family: 'Consolas', monospace;
        font-size: 0.9rem;
    }

    /* Email Templates */
    .email-templates {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
    }

    .template-item {
        background: var(--light);
        border: 1px solid var(--gray-light);
        border-radius: 8px;
        padding: 1rem;
        transition: var(--transition);
    }

    .template-item:hover {
        border-color: var(--primary);
        transform: translateY(-2px);
    }

    .template-item h4 {
        font-size: 1rem;
        color: var(--dark);
        margin-bottom: 0.5rem;
    }

    .template-item p {
        font-size: 0.9rem;
        color: var(--gray);
        margin-bottom: 1rem;
        line-height: 1.4;
    }

    /* Settings Actions */
    .settings-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        padding-top: 1.5rem;
        border-top: 1px solid var(--gray-light);
        margin-top: 1rem;
    }

    /* Settings Summary */
    .settings-summary {
        margin-top: 1.5rem;
    }

    .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
    }

    .summary-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.5rem;
        background: var(--light);
        border-radius: 12px;
        transition: var(--transition);
    }

    .summary-item:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    }

    .summary-icon {
        width: 50px;
        height: 50px;
        border-radius: 10px;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.25rem;
    }

    .summary-content h4 {
        font-size: 1rem;
        color: var(--dark);
        margin-bottom: 0.25rem;
        font-weight: 600;
    }

    .summary-content p {
        color: var(--gray);
        font-size: 0.9rem;
        margin: 0;
    }

    /* Animations */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Responsive */
    @media (max-width: 1024px) {
        .settings-tabs {
            flex-wrap: wrap;
        }
        
        .settings-tab {
            flex: 1;
            min-width: 150px;
            justify-content: center;
        }
        
        .form-row {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 768px) {
        .settings-tab span {
            display: none;
        }
        
        .settings-tab {
            padding: 1rem;
            justify-content: center;
        }
        
        .settings-tab i {
            font-size: 1.25rem;
        }
        
        .settings-actions {
            flex-direction: column;
        }
        
        .settings-actions .btn {
            width: 100%;
        }
        
        .summary-grid {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 480px) {
        .radio-option,
        .checkbox-option {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .email-templates {
            grid-template-columns: 1fr;
        }
        
        .summary-item {
            flex-direction: column;
            text-align: center;
        }
    }
</style>
{% endblock %}

{% block script %}
<script>
    // Tab switching functionality
    function showSettingsTab(tabName) {
        // Hide all tab contents
        document.querySelectorAll('.settings-tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // Remove active class from all tabs
        document.querySelectorAll('.settings-tab').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // Show selected tab content
        document.getElementById(tabName + 'Tab').classList.add('active');
        
        // Activate selected tab button
        document.querySelector(`.settings-tab[onclick*="${tabName}"]`).classList.add('active');
        
        // Save active tab to localStorage
        localStorage.setItem('activeSettingsTab', tabName);
    }
    
    // Restore active tab on page load
    document.addEventListener('DOMContentLoaded', function() {
        const activeTab = localStorage.getItem('activeSettingsTab') || 'general';
        showSettingsTab(activeTab);
        
        // Set up form submissions
        setupFormSubmissions();
    });
    
    // Form submission handlers
    function setupFormSubmissions() {
        document.getElementById('generalSettingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveSettings('general', this);
        });
        
        document.getElementById('securitySettingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveSettings('security', this);
        });
        
        document.getElementById('emailSettingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveSettings('email', this);
        });
    }
    
    // Save settings function
    function saveSettings(section, form) {
        showLoading();
        
        // Collect form data
        const formData = new FormData(form);
        const data = {};
        for (let [key, value] of formData.entries()) {
            data[key] = value;
        }
        
        // Simulate API call
        setTimeout(() => {
            hideLoading();
            
            showModal('Settings Saved', `
                <div class="success-message">
                    <div style="text-align: center; margin-bottom: 1.5rem;">
                        <i class="fas fa-check-circle" style="font-size: 3rem; color: var(--success); margin-bottom: 1rem;"></i>
                        <h3>${section.charAt(0).toUpperCase() + section.slice(1)} Settings Saved</h3>
                    </div>
                    <p>Your configuration changes have been saved successfully.</p>
                    <div class="modal-actions" style="margin-top: 1.5rem;">
                        <button class="btn btn-primary" onclick="closeModal()">OK</button>
                    </div>
                </div>
            `);
            
            // Update summary if needed
            updateSettingsSummary();
        }, 1500);
    }
    
    // Reset general settings
    function resetGeneralSettings() {
        if (confirm('Reset all general settings to default values?')) {
            showLoading();
            
            setTimeout(() => {
                hideLoading();
                
                showModal('Settings Reset', `
                    <div class="reset-message">
                        <div style="text-align: center; margin-bottom: 1.5rem;">
                            <i class="fas fa-undo" style="font-size: 3rem; color: var(--warning); margin-bottom: 1rem;"></i>
                            <h3>Settings Reset</h3>
                        </div>
                        <p>General settings have been reset to default values.</p>
                        <div class="modal-actions" style="margin-top: 1.5rem;">
                            <button class="btn btn-primary" onclick="closeModal(); location.reload();">Reload Page</button>
                        </div>
                    </div>
                `);
            }, 1000);
        }
    }
    
    // Run security scan
    function runSecurityScan() {
        showLoading();
        
        setTimeout(() => {
            hideLoading();
            
            showModal('Security Scan Results', `
                <div class="security-scan-results">
                    <div class="scan-summary">
                        <h4>Security Scan Completed</h4>
                        <p>Scan completed at ${new Date().toLocaleTimeString()}</p>
                    </div>
                    
                    <div class="scan-results">
                        <div class="result-item success">
                            <i class="fas fa-check-circle"></i>
                            <div>
                                <strong>Password Policy</strong>
                                <p>Strong password requirements enabled</p>
                            </div>
                        </div>
                        <div class="result-item success">
                            <i class="fas fa-check-circle"></i>
                            <div>
                                <strong>Session Management</strong>
                                <p>30-minute timeout configured</p>
                            </div>
                        </div>
                        <div class="result-item warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div>
                                <strong>Two-Factor Authentication</strong>
                                <p>2FA is disabled (consider enabling)</p>
                            </div>
                        </div>
                        <div class="result-item success">
                            <i class="fas fa-check-circle"></i>
                            <div>
                                <strong>IP Restrictions</strong>
                                <p>No IP restrictions configured</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="scan-recommendations">
                        <h5>Recommendations:</h5>
                        <ul>
                            <li>Enable Two-Factor Authentication for admin accounts</li>
                            <li>Consider implementing IP whitelist for sensitive areas</li>
                            <li>Review security logs regularly</li>
                        </ul>
                    </div>
                    
                    <div class="modal-actions" style="margin-top: 1.5rem;">
                        <button class="btn btn-primary" onclick="closeModal()">Close</button>
                        <button class="btn btn-outline" onclick="applySecurityRecommendations()">
                            Apply Recommendations
                        </button>
                    </div>
                </div>
            `);
        }, 2000);
    }
    
    function applySecurityRecommendations() {
        showLoading();
        
        setTimeout(() => {
            hideLoading();
            closeModal();
            alert('Security recommendations applied! Some settings may require manual configuration.');
        }, 1000);
    }
    
    // Test email connection
    function testEmailConnection() {
        showLoading();
        
        setTimeout(() => {
            hideLoading();
            
            showModal('Email Test', `
                <div class="email-test-results">
                    <div style="text-align: center; margin-bottom: 1.5rem;">
                        <i class="fas fa-envelope" style="font-size: 3rem; color: var(--primary); margin-bottom: 1rem;"></i>
                        <h3>Test Email Connection</h3>
                    </div>
                    
                    <div class="test-status success">
                        <i class="fas fa-check-circle"></i>
                        <div>
                            <strong>Connection Successful</strong>
                            <p>SMTP server connection established successfully.</p>
                        </div>
                    </div>
                    
                    <div class="test-details">
                        <p>A test email has been sent to the configured administrator email address.</p>
                        <p>Please check your inbox to confirm email delivery.</p>
                    </div>
                    
                    <div class="modal-actions" style="margin-top: 1.5rem;">
                        <button class="btn btn-primary" onclick="closeModal()">OK</button>
                        <button class="btn btn-outline" onclick="sendAnotherTest()">
                            Send Another Test
                        </button>
                    </div>
                </div>
            `);
        }, 2000);
    }
    
    function sendAnotherTest() {
        alert('Another test email sent!');
        closeModal();
    }
    
    // Edit email template
    function editTemplate(templateName)